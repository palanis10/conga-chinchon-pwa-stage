<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Conga by Alanis — STAGE v3.5.8</title>

  <!-- Prevent accidental zooming on mobile -->
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

  <meta name="theme-color" content="#0b1222" />

  <style>
    :root{
      --bg:#0b1222;
      --panel:#121c30;
      --panel2:#101a2b;
      --chip:#1b2944;
      --chip-border:#3a4d71;
      --text:#e7eefc;
      --sub:#aeb9cd;
      --brand1:#8aa8ff;
      --brand2:#c49bff;
      --ok:#64efb2;
      --warn:#ff8c8c;
      --teal:#3ff3c0;
      --ring:#2bd8a8;
      --shadow:0 12px 30px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 800px at 20% -10%, #0f1a2e 60%, var(--bg));
    }

    .container{max-width:980px;margin:0 auto;padding:20px 16px 48px}

    /* ===== Header (v3.5.5 look) ===== */
    .header{
      display:grid;
      grid-template-columns:minmax(0,1fr) auto auto;
      align-items:center;
      gap:12px;
      margin-top:6px;
    }
    .title-wrap{min-width:0}
    .title{
      font-weight:800;
      font-size:clamp(22px,6vw,32px);
      line-height:1.1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .stage{
      margin-top:6px;
      font-weight:700;
      color:var(--sub);
      letter-spacing:.5px;
      font-size:clamp(12px,3.4vw,14px);
    }
    .lang{
      display:flex;align-items:center;gap:10px;
      background:rgba(255,255,255,.06);
      border:1px dashed rgba(255,255,255,.15);
      padding:10px 14px;border-radius:999px;
      backdrop-filter: blur(4px);
    }
    .lang button{
      border:0;background:transparent;color:var(--sub);
      font-weight:800;letter-spacing:.5px;
      padding:8px 12px;border-radius:10px;cursor:pointer
    }
    .lang button.active{background:#1e2a44;color:var(--text)}
    .icon-btn{
      width:44px;height:44px;border-radius:12px;display:grid;place-items:center;
      background:rgba(255,255,255,.07);border:1px dashed rgba(255,255,255,.15);cursor:pointer
    }

    /* ===== Controls row ===== */
    .controls{
      margin-top:16px;
      background:linear-gradient(180deg, var(--panel), var(--panel2));
      border-radius:20px;padding:16px;box-shadow:var(--shadow)
    }
    .chip-row{
      display:flex;gap:12px;align-items:center;justify-content:flex-start;
      flex-wrap:nowrap;
    }
    .chip{
      display:flex;align-items:center;gap:10px;
      padding:12px 16px;border-radius:16px;
      background:rgba(255,255,255,.06);
      border:2px dashed rgba(255,255,255,.18);
      color:var(--text);font-weight:800;white-space:nowrap;
      min-width:0;flex:1 1 0; /* forces one row even on iPhone */
      justify-content:center;
    }
    .chip .lock{
      width:18px;height:18px;border-radius:4px;
      background: linear-gradient(#f9e48a, #caa12e);
      display:inline-block;position:relative
    }
    .chip .lock:before{
      content:"";position:absolute;left:50%;top:-6px;transform:translateX(-50%);
      width:12px;height:8px;border:3px solid #caa12e;border-bottom:0;border-radius:10px
    }
    .chip.solid{
      background:linear-gradient(135deg, #8aa8ff, #c49bff);
      border:0;color:#0b1222;box-shadow:0 8px 18px rgba(69,105,255,.35);
      font-weight:900;
    }

    /* ===== Section titles ===== */
    .section-title{margin:18px 6px 10px;color:var(--sub);font-weight:700}

    /* ===== Players ===== */
    .players{display:flex;flex-direction:column;gap:14px}
    .row{
      background:linear-gradient(180deg, #0f1a2a, #0d1728);
      border-radius:20px;padding:16px;
      outline:2px solid rgba(255,255,255,.06);
      box-shadow:var(--shadow)
    }
    .row.active{outline-color:rgba(47,255,205,.45)}
    .row-body{display:grid;grid-template-columns:28px 72px 1fr auto;align-items:center;gap:14px}
    .handle{font-size:20px;color:var(--sub);opacity:.9}
    .badge{
      width:60px;height:60px;border-radius:50%;display:grid;place-items:center;
      color:var(--text);font-weight:900;background:#15223b;position:relative
    }
    .badge:before{
      content:"";position:absolute;inset:-6px;border-radius:50%;
      border:6px solid var(--ring);opacity:.9
    }
    .pname{font-size:clamp(16px,5.2vw,28px);font-weight:900}
    .score{font-size:clamp(16px,5.2vw,28px);font-weight:900;opacity:.95}

    .add-player{
      border:2px dashed rgba(255,255,255,.25);
      border-radius:18px;padding:18px;text-align:center;color:var(--text);
      font-weight:800;background:transparent;cursor:pointer
    }

    /* Utility */
    dialog{border:0;background:transparent}
    .modal{
      background:linear-gradient(180deg, var(--panel), var(--panel2));
      border-radius:18px;padding:18px;min-width:min(520px,90vw);color:var(--text);
      box-shadow:var(--shadow)
    }
    .modal .hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    .btn{border:0;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer}
    .btn.ghost{background:rgba(255,255,255,.08);color:var(--text)}
    .btn.primary{background:var(--ok);color:#0b1222}

    /* Make sure the three chips stay on the same row even in ES text */
    @media (max-width:420px){
      .chip{padding:12px 10px;font-size:15px}
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header" id="hdr">
      <div class="title-wrap">
        <div class="title" id="appTitle">Conga by Alanis</div>
        <div class="stage" id="appStage">STAGE v3.5.8</div>
      </div>

      <div class="lang" id="langWrap" role="group" aria-label="Language">
        <button id="langEN" class="active" type="button">EN</button>
        <span style="opacity:.4">|</span>
        <button id="langES" type="button">ES</button>
      </div>

      <button class="icon-btn" id="btnSettings" title="Settings">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
          <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z"
                stroke="currentColor" stroke-width="2"/>
          <path d="M19.4 15a1 1 0 0 0 .2 1.1l.1.2a1 1 0 0 1-.2 1.4l-1.1.9a1 1 0 0 1-1.2.1l-1.1-.6a1 1 0 0 0-1.1.1l-.3.2a1 1 0 0 0-.4 1.1l.2 1.3a1 1 0 0 1-1 .9h-1.4a1 1 0 0 1-1-.9l.2-1.3a1 1 0 0 0-.4-1.1l-.3-.2a1 1 0 0 0-1.1-.1l-1.1.6a1 1 0 0 1-1.2-.1l-1.1-.9a1 1 0 0 1-.2-1.4l.1-.2a1 1 0 0 0 .2-1.1l-.1-.3a1 1 0 0 0-1-.7l-1.3-.1a1 1 0 0 1-.9-1v-1.4a1 1 0 0 1 .9-1l1.3-.1a1 1 0 0 0 1-.7l.1-.3a1 1 0 0 0-.2-1.1l-.1-.2a1 1 0 0 1 .2-1.4l1.1-.9a1 1 0 0 1 1.2-.1l1.1.6a1 1 0 0 0 1.1-.1l.3-.2a1 1 0 0 0 .4-1.1l-.2-1.3a1 1 0 0 1 1-.9h1.4a1 1 0 0 1 1 .9l-.2 1.3a1 1 0 0 0 .4 1.1l.3.2a1 1 0 0 0 1.1.1l1.1-.6a1 1 0 0 1 1.2.1l1.1.9a1 1 0 0 1 .2 1.4l-.1.2a1 1 0 0 0-.2 1.1l.1.3a1 1 0 0 0 1 .7l1.3.1a1 1 0 0 1 .9 1v1.4a1 1 0 0 1-.9 1l-1.3.1a1 1 0 0 0-1 .7l-.1.3Z"
                stroke="currentColor" stroke-width="1.4"/>
        </svg>
      </button>
    </header>

    <!-- Controls row -->
    <section class="controls">
      <div class="chip-row">
        <button id="btnReorder" class="chip" type="button">
          <i class="lock" aria-hidden="true"></i>
          <span data-i18n="reorder">Reorder</span>
        </button>
        <button id="btnHistory" class="chip" type="button">
          <span data-i18n="history">History</span>
        </button>
        <button id="btnNewRound" class="chip solid" type="button">
          <span data-i18n="newRound">New round</span>
        </button>
      </div>
    </section>

    <!-- Players -->
    <h3 class="section-title" id="playersLabel">Players</h3>
    <div id="players" class="players"></div>

    <button id="addPlayer" class="add-player" type="button">
      <span id="addPlayerLbl">+ Add player</span>
    </button>
  </div>

  <!-- Settings (placeholder) -->
  <dialog id="settings">
    <div class="modal" role="dialog" aria-labelledby="sH">
      <div class="hd">
        <strong id="sH">Settings</strong>
        <button class="btn ghost" onclick="settings.close()">Close</button>
      </div>
      <p style="margin:0 0 6px;color:var(--sub)">Language</p>
      <div class="lang">
        <button id="setEN" class="active" type="button">EN</button>
        <span style="opacity:.4">|</span>
        <button id="setES" type="button">ES</button>
      </div>
      <div style="height:10px"></div>
      <button class="btn primary" onclick="settings.close()">Done</button>
    </div>
  </dialog>

  <script>
    /**********************
     * i18n
     *********************/
    const STRINGS = {
      en:{
        title:"Conga by Alanis",
        stage:"STAGE v3.5.8",
        players:"Players",
        reorder:"Reorder",
        history:"History",
        newRound:"New round",
        addPlayer:"+ Add player",
        P:"P"
      },
      es:{
        title:"Conga por Alanis",
        stage:"ETAPA v3.5.8",
        players:"Jugadores",
        reorder:"Reordenar",
        history:"Historial",
        newRound:"Nueva ronda",
        addPlayer:"+ Agregar jugador",
        P:"J"
      }
    };

    /**********************
     * State & storage
     *********************/
    const STORAGE_KEY = "conga_state_v1";
    const LANG_KEY = "conga_lang";

    const defaultState = () => ({
      players: [],
      nextDealer: 0
    });

    function loadState(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return defaultState();
        return JSON.parse(raw);
      }catch(e){
        return defaultState();
      }
    }
    function saveState(s){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(s));
    }

    function ensureMinimumPlayers(state){
      const MIN = 2;
      const defaults = ["Player 1", "Player 2"];
      if(!Array.isArray(state.players)) state.players = [];
      while(state.players.length < MIN){
        const i = state.players.length;
        state.players.push({
          id: crypto?.randomUUID?.() || `${Date.now()}_${Math.random()}`,
          name: defaults[i] || `Player ${i+1}`,
          score: 0,
          avatar: null,
          eliminated: false
        });
      }
    }

    /**********************
     * Render
     *********************/
    const $ = sel => document.querySelector(sel);
    const elPlayers = $("#players");

    function render(){
      // i18n
      const dict = STRINGS[currentLang()];
      $("#appTitle").textContent = dict.title;
      $("#appStage").textContent = dict.stage;
      $("#playersLabel").textContent = dict.players;
      document.querySelectorAll("[data-i18n='reorder']").forEach(n => n.textContent = dict.reorder);
      document.querySelectorAll("[data-i18n='history']").forEach(n => n.textContent = dict.history);
      document.querySelectorAll("[data-i18n='newRound']").forEach(n => n.textContent = dict.newRound);
      $("#addPlayerLbl").textContent = dict.addPlayer;

      // header lang pills active state
      $("#langEN").classList.toggle("active", currentLang()==="en");
      $("#langES").classList.toggle("active", currentLang()==="es");
      $("#setEN").classList.toggle("active", currentLang()==="en");
      $("#setES").classList.toggle("active", currentLang()==="es");

      // players
      const s = loadState();
      ensureMinimumPlayers(s);
      saveState(s);

      elPlayers.innerHTML = "";
      s.players.forEach((p, idx) => {
        const row = document.createElement("div");
        row.className = "row" + (idx===s.nextDealer ? " active":"");
        row.dataset.id = p.id;

        const body = document.createElement("div");
        body.className = "row-body";

        const handle = document.createElement("div");
        handle.className = "handle";
        handle.textContent = "≡";
        body.appendChild(handle);

        const badge = document.createElement("div");
        badge.className = "badge";
        badge.textContent = (STRINGS[currentLang()].P) + (idx+1);
        body.appendChild(badge);

        const name = document.createElement("div");
        name.className = "pname";
        name.textContent = p.name;
        body.appendChild(name);

        const score = document.createElement("div");
        score.className = "score";
        score.textContent = p.score;
        body.appendChild(score);

        row.appendChild(body);
        elPlayers.appendChild(row);
      });
    }

    /**********************
     * Language
     *********************/
    function currentLang(){
      return localStorage.getItem(LANG_KEY) || "en";
    }
    function setLang(l){
      localStorage.setItem(LANG_KEY, l);
      render();
    }

    $("#langEN").addEventListener("click", () => setLang("en"));
    $("#langES").addEventListener("click", () => setLang("es"));
    $("#setEN").addEventListener("click", () => setLang("en"));
    $("#setES").addEventListener("click", () => setLang("es"));

    /**********************
     * Actions
     *********************/
    $("#btnSettings").addEventListener("click", () => settings.showModal());

    $("#addPlayer").addEventListener("click", () => {
      const s = loadState();
      ensureMinimumPlayers(s);
      const n = s.players.length + 1;
      s.players.push({
        id: crypto?.randomUUID?.() || `${Date.now()}_${Math.random()}`,
        name: currentLang()==="es" ? `Jugador ${n}` : `Player ${n}`,
        score: 0,
        avatar: null,
        eliminated:false
      });
      saveState(s);
      render();
    });

    // Placeholder actions
    $("#btnReorder").addEventListener("click", () => {
      alert(currentLang()==="es" ? "Modo reordenar (placeholder)" : "Reorder mode (placeholder)");
    });
    $("#btnHistory").addEventListener("click", () => {
      alert(currentLang()==="es" ? "Historial (placeholder)" : "History (placeholder)");
    });
    $("#btnNewRound").addEventListener("click", () => {
      alert(currentLang()==="es" ? "Nueva ronda (placeholder)" : "New round (placeholder)");
    });

    /**********************
     * Boot
     *********************/
    // Initialize state once and ensure we always start with 2 players
    (function init(){
      const s = loadState();
      ensureMinimumPlayers(s);
      saveState(s);
      render();
    })();
  </script>
</body>
</html>
